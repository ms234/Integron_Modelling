% ======================================================================
% Function to excise a cassette from the integron and return the resulting
% new genotype. Input parameters: 
% - currGenotype -  the current genotype (array of cassettes in the
% integron).
% - cassetteToExcise - the position of the cassette to be excised.
% - k - Length of the integron.
% ======================================================================
currGenotype = [1 2 3];
cassetteToExcise = 3;
% function newGenotype = exciseCassette(currGenotype, cassetteToExcise, k)
% Initialise variables
newGenotype = currGenotype; % Array for genotype after excision
k = length(currGenotype); % 

% Excise the cassette
newGenotype(cassetteToExcise) = 0;

% Resort the cassettes so that any gaps created by excising the cassette
% are moved to the end of the integron. This is to prevent having a genotype 
% like [1 0 2]
% Excise the cassette by shifting everything that follows after it one
% position forward. For example, if we want to
% remove the 1st cassette in [1 2 3] we proceed by moving [2 3] one index 
% to the left to get [2 3 3] and then zero out the last index
newGenotype(cassetteToExcise:(k-1)) = newGenotype((cassetteToExcise+1):k);
newGenotype(end) = 0;

newGenotype
% end